<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vacation Countdown & Workout Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icon components
        const Calendar = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Trophy = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path>
                <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path>
                <path d="M4 22h16"></path>
                <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"></path>
                <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"></path>
                <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"></path>
            </svg>
        );

        const Target = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="6"></circle>
                <circle cx="12" cy="12" r="2"></circle>
            </svg>
        );

        const Settings = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m-9-9h6m6 0h6"></path>
                <path d="M19.07 4.93l-4.24 4.24M9.17 14.83L4.93 19.07m14.14 0l-4.24-4.24M9.17 9.17L4.93 4.93"></path>
            </svg>
        );

        const Plus = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const X = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        function VacationWorkoutTracker() {
            const [setupComplete, setSetupComplete] = useState(false);
            const [showSetup, setShowSetup] = useState(false);
            const [vacationDate, setVacationDate] = useState('');
            const [vacationTitle, setVacationTitle] = useState('');
            const [users, setUsers] = useState([]);
            const [workouts, setWorkouts] = useState({});
            const [selectedMonth, setSelectedMonth] = useState(new Date());
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                try {
                    const configStr = localStorage.getItem('vacation-config');
                    if (configStr) {
                        const config = JSON.parse(configStr);
                        setVacationDate(config.vacationDate);
                        setVacationTitle(config.vacationTitle);
                        setUsers(config.users);
                        setSetupComplete(true);
                    }

                    const workoutsStr = localStorage.getItem('vacation-workouts');
                    if (workoutsStr) {
                        setWorkouts(JSON.parse(workoutsStr));
                    }
                } catch (error) {
                    console.log('No existing data found');
                } finally {
                    setLoading(false);
                }
            };

            const saveConfig = () => {
                const config = { vacationDate, vacationTitle, users };
                localStorage.setItem('vacation-config', JSON.stringify(config));
            };

            const saveWorkouts = (newWorkouts) => {
                localStorage.setItem('vacation-workouts', JSON.stringify(newWorkouts));
            };

            const handleSetupSave = () => {
                if (!vacationDate || !vacationTitle || users.length === 0) {
                    alert('Please fill in all fields and add at least one user');
                    return;
                }
                saveConfig();
                setSetupComplete(true);
                setShowSetup(false);
            };

            const addUser = (name) => {
                if (name.trim() && !users.includes(name.trim())) {
                    setUsers([...users, name.trim()]);
                }
            };

            const removeUser = (name) => {
                setUsers(users.filter(u => u !== name));
            };

            const toggleWorkout = (date, user) => {
                const dateStr = date.toISOString().split('T')[0];
                const key = dateStr + '-' + user;
                const newWorkouts = { ...workouts };
                
                if (newWorkouts[key]) {
                    delete newWorkouts[key];
                } else {
                    newWorkouts[key] = true;
                }
                
                setWorkouts(newWorkouts);
                saveWorkouts(newWorkouts);
            };

            const getWorkoutCount = (user) => {
                return Object.keys(workouts).filter(key => key.endsWith('-' + user)).length;
            };

            const getDaysToVacation = () => {
                if (!vacationDate) return 0;
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const vacation = new Date(vacationDate);
                vacation.setHours(0, 0, 0, 0);
                const diff = vacation - today;
                return Math.ceil(diff / (1000 * 60 * 60 * 24));
            };

            const getStartDate = () => {
                if (!vacationDate) return new Date();
                const vacation = new Date(vacationDate);
                const start = new Date(vacation);
                start.setDate(start.getDate() - 100);
                return start;
            };

            const renderCalendar = () => {
                const year = selectedMonth.getFullYear();
                const month = selectedMonth.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = getStartDate();
                const endDate = new Date(vacationDate);
                
                const daysInMonth = lastDay.getDate();
                const startDayOfWeek = firstDay.getDay();
                
                const days = [];
                for (let i = 0; i < startDayOfWeek; i++) {
                    days.push(null);
                }
                for (let i = 1; i <= daysInMonth; i++) {
                    days.push(new Date(year, month, i));
                }

                return (
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <div className="flex items-center justify-between mb-6">
                            <button
                                onClick={() => setSelectedMonth(new Date(selectedMonth.getFullYear(), selectedMonth.getMonth() - 1))}
                                className="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300"
                            >
                                ←
                            </button>
                            <h3 className="text-xl font-bold">
                                {selectedMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
                            </h3>
                            <button
                                onClick={() => setSelectedMonth(new Date(selectedMonth.getFullYear(), selectedMonth.getMonth() + 1))}
                                className="px-3 py-1 bg-gray-200 rounded hover:bg-gray-300"
                            >
                                →
                            </button>
                        </div>

                        <div className="grid grid-cols-7 gap-2 mb-2">
                            {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                                <div key={day} className="text-center font-semibold text-gray-600 text-sm">
                                    {day}
                                </div>
                            ))}
                        </div>

                        <div className="grid grid-cols-7 gap-2">
                            {days.map((day, idx) => {
                                if (!day) return <div key={idx} />;
                                
                                const isInRange = day >= startDate && day <= endDate;
                                const isToday = day.toDateString() === new Date().toDateString();
                                const dateStr = day.toISOString().split('T')[0];
                                
                                const bgClass = !isInRange ? 'bg-gray-100 text-gray-400' : 'bg-white';
                                const ringClass = isToday ? ' ring-2 ring-blue-500' : '';
                                
                                return (
                                    <div
                                        key={idx}
                                        className={'aspect-square border rounded ' + bgClass + ringClass}
                                    >
                                        <div className="text-xs text-center p-1 font-semibold">{day.getDate()}</div>
                                        {isInRange && (
                                            <div className="flex flex-col gap-1 px-1">
                                                {users.map(user => {
                                                    const key = dateStr + '-' + user;
                                                    const hasWorkout = workouts[key];
                                                    return (
                                                        <button
                                                            key={user}
                                                            onClick={() => toggleWorkout(day, user)}
                                                            className={'w-full h-3 rounded text-xs ' + (hasWorkout ? 'bg-green-500' : 'bg-gray-200')}
                                                            title={user + ': ' + (hasWorkout ? 'Workout done' : 'No workout')}
                                                        />
                                                    );
                                                })}
                                            </div>
                                        )}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center">
                        <div className="text-xl">Loading...</div>
                    </div>
                );
            }

            if (!setupComplete || showSetup) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-8">
                        <div className="max-w-2xl mx-auto bg-white rounded-lg shadow-xl p-8">
                            <h1 className="text-3xl font-bold mb-6 text-center">Setup Your Tracker</h1>
                            
                            <div className="space-y-6">
                                <div>
                                    <label className="block text-sm font-semibold mb-2">Vacation Title</label>
                                    <input
                                        type="text"
                                        value={vacationTitle}
                                        onChange={(e) => setVacationTitle(e.target.value)}
                                        placeholder="e.g., Hawaii Trip"
                                        className="w-full px-4 py-2 border rounded-lg"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">Vacation Date</label>
                                    <input
                                        type="date"
                                        value={vacationDate}
                                        onChange={(e) => setVacationDate(e.target.value)}
                                        className="w-full px-4 py-2 border rounded-lg"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold mb-2">Users</label>
                                    <div className="flex gap-2 mb-3">
                                        <input
                                            type="text"
                                            id="newUser"
                                            placeholder="Enter name"
                                            className="flex-1 px-4 py-2 border rounded-lg"
                                            onKeyPress={(e) => {
                                                if (e.key === 'Enter') {
                                                    addUser(e.target.value);
                                                    e.target.value = '';
                                                }
                                            }}
                                        />
                                        <button
                                            onClick={() => {
                                                const input = document.getElementById('newUser');
                                                addUser(input.value);
                                                input.value = '';
                                            }}
                                            className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                                        >
                                            <Plus size={20} />
                                        </button>
                                    </div>
                                    <div className="space-y-2">
                                        {users.map(user => (
                                            <div key={user} className="flex items-center justify-between bg-gray-50 px-4 py-2 rounded-lg">
                                                <span>{user}</span>
                                                <button
                                                    onClick={() => removeUser(user)}
                                                    className="text-red-500 hover:text-red-700"
                                                >
                                                    <X size={18} />
                                                </button>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="flex gap-4">
                                    <button
                                        onClick={handleSetupSave}
                                        className="flex-1 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 font-semibold"
                                    >
                                        Save Setup
                                    </button>
                                    {setupComplete && (
                                        <button
                                            onClick={() => setShowSetup(false)}
                                            className="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                                        >
                                            Cancel
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            const daysToVacation = getDaysToVacation();

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex justify-between items-center mb-8">
                            <h1 className="text-4xl font-bold text-gray-800">{vacationTitle}</h1>
                            <button
                                onClick={() => setShowSetup(true)}
                                className="px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300"
                            >
                                <Settings size={24} />
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div className="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-lg p-8 text-white">
                                <div className="flex items-center gap-3 mb-4">
                                    <Calendar size={32} />
                                    <h2 className="text-2xl font-bold">Countdown</h2>
                                </div>
                                <div className="text-6xl font-bold mb-2">{daysToVacation}</div>
                                <div className="text-xl">days to vacation!</div>
                                <div className="text-sm mt-2 opacity-90">
                                    {new Date(vacationDate).toLocaleDateString('en-US', { 
                                        weekday: 'long', 
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric' 
                                    })}
                                </div>
                            </div>

                            <div className="bg-white rounded-lg shadow-lg p-8">
                                <div className="flex items-center gap-3 mb-4">
                                    <Trophy size={32} className="text-yellow-500" />
                                    <h2 className="text-2xl font-bold">Workout Progress</h2>
                                </div>
                                <div className="space-y-3">
                                    {users.map(user => {
                                        const count = getWorkoutCount(user);
                                        const percentage = Math.round((count / 100) * 100);
                                        return (
                                            <div key={user}>
                                                <div className="flex justify-between mb-1">
                                                    <span className="font-semibold">{user}</span>
                                                    <span className="text-gray-600">{count} / 100 workouts</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-4">
                                                    <div
                                                        className="bg-green-500 h-4 rounded-full transition-all"
                                                        style={{ width: percentage + '%' }}
                                                    />
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>

                        <div className="mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div className="flex items-start gap-3">
                                <Target className="text-blue-600 mt-1" size={20} />
                                <div>
                                    <div className="font-semibold text-blue-900">100-Day Challenge</div>
                                    <div className="text-sm text-blue-700">
                                        Started: {getStartDate().toLocaleDateString()} • Click colored bars to log workouts
                                    </div>
                                    <div className="flex gap-4 mt-2">
                                        {users.map(user => (
                                            <div key={user} className="flex items-center gap-2 text-sm">
                                                <div className="w-4 h-4 rounded bg-green-500" />
                                                <span>{user}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {renderCalendar()}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<VacationWorkoutTracker />);
    </script>
</body>
</html>